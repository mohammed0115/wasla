{% extends "base_public.html" %}
{% load i18n %}

{% block title %}{% trans "Business type" %} | Wasla{% endblock %}

{% block content %}
<div class="row justify-content-center">
  <div class="col-12 col-md-10 col-lg-8">
    <div class="card shadow-sm">
      <div class="card-body p-4 p-md-5">
        <h1 class="h4 mb-2">{% trans "Choose your business type" %}</h1>
        <p class="text-muted mb-4">
          {% blocktrans with min=min max=max %}Pick at least {{ min }} and at most {{ max }}.{% endblocktrans %}
        </p>

        <form method="post" id="biz-form">
          {% csrf_token %}

          <div class="d-flex flex-wrap gap-2">
            {% for code, label in options %}
              <input
                type="checkbox"
                class="btn-check"
                id="bt-{{ code }}"
                name="business_types"
                value="{{ code }}"
                {% if code in selected %}checked{% endif %}
              >
              <label class="btn btn-outline-primary rounded-pill" for="bt-{{ code }}">{{ label }}</label>
            {% endfor %}
          </div>

          <div class="mt-4 d-flex justify-content-between align-items-center">
            <a class="btn btn-outline-secondary" href="{% url 'onboarding:country' %}">{% trans "Back" %}</a>
            <button class="btn btn-primary" type="submit">{% trans "Continue" %}</button>
          </div>

          <div class="mt-3 text-muted small">{% trans "Step 2 of 3" %}</div>
        </form>
      </div>
    </div>
  </div>
</div>

{% endblock %}

{% block extra_js %}
<script>
  (function () {
    const max = Number("{{ max }}");
    const inputs = Array.from(document.querySelectorAll("input[name='business_types']"));
    function enforceMax() {
      const checked = inputs.filter(i => i.checked).length;
      inputs.forEach(i => {
        if (!i.checked) i.disabled = checked >= max;
      });
    }
    inputs.forEach(i => i.addEventListener("change", enforceMax));
    enforceMax();
  })();
</script>
{% endblock %}
